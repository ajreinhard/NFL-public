panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line.x.bottom = element_line(color = 'darkblue', size = 1.2),
axis.line.y = element_blank()
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 600, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
hist_logo_url
all_weeks
all_weeks <- elo_df %>%
filter(season >= 1966) %>%
select(season, week) %>%
distinct %>%
mutate(
week_order = row_number(),
week_name = paste0('As of Week ',week, ', ', season)
)
all_weeks
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(
retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T),
team = ifelse(season >= retire_season, 'RET', team)
) %>%
ungroup %>%
filter(rank <= 20 & week_order < 132) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
ggplot(aes(y = rank, x = wins, group = team_qb, color = color_key, fill = color_key)) +
geom_barh(stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005), color = 'white', hjust = 1, size = 7, family = font_SB) +
#geom_image(aes(image = logo_ur), asp = 2.25) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,280,40), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey30')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line.x.bottom = element_line(color = 'darkblue', size = 1.2),
axis.line.y = element_blank()
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 600, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(
retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)
#team = ifelse(season >= retire_season, 'RET', team)
) %>%
ungroup %>%
filter(rank <= 20 & week_order < 44) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
ggplot(aes(y = rank, x = wins, group = team_qb, color = color_key, fill = color_key)) +
geom_barh(stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005), color = 'white', hjust = 1, size = 7, family = font_SB) +
#geom_image(aes(image = logo_ur), asp = 2.25, size = 0.02) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,280,40), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'NA' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'NA' = 'grey30')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 2),
axis.line.y = element_blank()
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 200, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
vid_theme_SB
vid_theme_SB$axis.ticks
vid_theme_SB$axis
vid_theme_SB$axis.line
vid_theme_SB()
vid_theme_SB
c(NFL_pri, 'NA' = 'grey70')
c(NFL_pri, NA = 'grey70')
qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order < 44) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(color_key = ifelse(season >= retire_season, 'RET', color_key))
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order < 44) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(
status = ifelse(season >= retire_season, 'Retired', 'Active'),
color_key = ifelse(status == 'Retired', 'RET', color_key)
) %>%
ggplot(aes(y = rank, x = wins, group = team_qb, color = color_key, fill = color_key)) +
geom_barh(stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005, color = status), color = 'white', hjust = 1, size = 7, family = font_SB, show.legend = F) +
#geom_image(aes(image = logo_ur), asp = 2.25, size = 0.02) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,280,40), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey20', 'Active' = 'white', 'Retired' = 'grey20', 'Hall' = 'gold4')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 1.5)
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 200, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order < 44) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(
status = ifelse(season >= retire_season, 'Retired', 'Active'),
color_key = ifelse(status == 'Retired', 'RET', color_key)
) %>%
ggplot(aes(y = rank, x = wins, group = team_qb, color = color_key, fill = color_key)) +
geom_barh(stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005, color = status), color = 'white', hjust = 1, size = 7, family = font_SB, show.legend = F) +
geom_image(aes(image = logo_ur, x = wins + wins_leader * 0.02), asp = 2.25, size = 0.02) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,280,40), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey20', 'Active' = 'white', 'Retired' = 'grey20', 'Hall' = 'gold4')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 1.5)
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 200, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order < 44) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(
status = ifelse(season >= retire_season, 'Retired', 'Active'),
color_key = ifelse(status == 'Retired', 'RET', color_key)
) %>%
ggplot(aes(y = rank, x = wins, group = team_qb, color = color_key, fill = color_key)) +
geom_barh(stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005, color = status), color = 'white', hjust = 1, size = 7, family = font_SB, show.legend = F) +
geom_image(aes(image = logo_url, x = wins + wins_leader * 0.02), asp = 2.25, size = 0.02) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,280,40), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey20', 'Active' = 'white', 'Retired' = 'grey20', 'Hall' = 'gold4')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 1.5)
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 200, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order < 44) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(
status = ifelse(season >= retire_season, 'Retired', 'Active'),
color_key = ifelse(status == 'Retired', 'RET', color_key)
) %>%
ggplot(aes(y = rank, x = wins, group = team_qb)) +
geom_barh(aes(color = color_key, fill = color_key), stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005, color = status), hjust = 1, size = 7, family = font_SB, show.legend = F) +
geom_image(aes(image = logo_url, x = wins + wins_leader * 0.02), asp = 2.25, size = 0.03) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,280,40), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey20', 'Active' = 'white', 'Retired' = 'grey20', 'Hall' = 'gold4')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 1.5)
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 200, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order > 500 & week_order < 545) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(
status = ifelse(season >= retire_season, 'Retired', 'Active'),
color_key = ifelse(status == 'Retired', 'RET', color_key)
) %>%
ggplot(aes(y = rank, x = wins, group = team_qb)) +
geom_barh(aes(color = color_key, fill = color_key), stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005, color = status), hjust = 1, size = 7, family = font_SB, show.legend = F) +
geom_image(aes(image = logo_url, x = wins + wins_leader * 0.02), asp = 2.25, size = 0.03) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,280,40), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey20', 'Active' = 'white', 'Retired' = 'grey20', 'Hall' = 'gold4')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 1.5)
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 200, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order > 800 & week_order < 932) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(
status = ifelse(season >= retire_season, 'Retired', 'Active'),
color_key = ifelse(status == 'Retired', 'RET', color_key)
) %>%
ggplot(aes(y = rank, x = wins, group = team_qb)) +
geom_barh(aes(color = color_key, fill = color_key), stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005, color = status), hjust = 1, size = 7, family = font_SB, show.legend = F) +
geom_image(aes(image = logo_url, x = wins + wins_leader * 0.02), asp = 2.25, size = 0.03) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,300,25), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey20', 'Active' = 'white', 'Retired' = 'grey20', 'Hall' = 'gold4')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 1.5)
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 600, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order > 960) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(
status = ifelse(season >= retire_season, 'Retired', 'Active'),
color_key = ifelse(status == 'Retired', 'RET', color_key)
) %>%
ggplot(aes(y = rank, x = wins, group = team_qb)) +
geom_barh(aes(color = color_key, fill = color_key), stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005, color = status), hjust = 1, size = 7, family = font_SB, show.legend = F) +
geom_image(aes(image = logo_url, x = wins + wins_leader * 0.02), asp = 2.25, size = 0.03) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,300,25), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey20', 'Active' = 'white', 'Retired' = 'grey20', 'Hall' = 'gold4')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 1.5)
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate_SB(my_ani, nframes = 600, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
#
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate_SB(my_ani, data_home = 'Data: FiveThirtyEight', nframes = 600, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
my_ani <- qb_wins %>%
left_join(weekly_qb_team) %>%
group_by(team_qb) %>%
mutate(retire_season = max(ifelse(!is.na(team), season + 1, NA), na.rm = T)) %>%
ungroup %>%
filter(rank <= 20 & week_order > 960) %>%
team2fran %>%
hist_color_map %>%
hist_logo_url %>%
mutate(
status = ifelse(season >= retire_season, 'Retired', 'Active'),
color_key = ifelse(status == 'Retired', 'RET', color_key)
) %>%
ggplot(aes(y = rank, x = wins, group = team_qb)) +
geom_barh(aes(color = color_key, fill = color_key), stat = 'identity', show.legend = F, size = 2, width = 0.8) +
geom_text(aes(label = team_qb, x = wins - wins_leader * 0.005, color = status), hjust = 1, size = 7, family = font_SB, show.legend = F) +
geom_image(aes(image = logo_url, x = wins + wins_leader * 0.02), asp = 2.25, size = 0.03) +
scale_y_reverse(expand = expansion(mult = c(0.01, 0.01))) +
scale_x_continuous(expand = expansion(mult = c(0, 0.05)), breaks = seq(0,300,25), labels = comma_format(accuracy = 1)) +
scale_fill_manual(values = c(NFL_pri, 'RET' = 'grey70')) +
scale_color_manual(values = c(NFL_sec, 'RET' = 'grey20', 'Active' = 'white', 'Retired' = 'grey20', 'Hall' = 'gold4')) +
labs(title = 'Wins as a Starting QB by Super Bowl Era Players',
subtitle = '{all_weeks$week_name[as.numeric(previous_state)]}  |  min. 1 QB Start in Super Bowl Era (1966-Present)',
x = NULL,
y = 'QB Winz') +
vid_theme_SB +
theme(
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
panel.grid.major.x = element_line(color='grey70', size = 1.2),
axis.line = element_line(color = 'darkblue', size = 1.5)
) +
transition_states(week_order, transition_length = 5, state_length = 1, wrap = F) +
view_follow(fixed_y = T) +
enter_fly(y_loc = -21) +
exit_fly(y_loc = -21) +
ease_aes('linear')
#data_home = 'Data: FiveThirtyEight'
anim_save(filename = 'graphs/qb winz short.mp4', animation = animate(my_ani, nframes = 600, fps = 40, height = 900, width = 1600, renderer = ffmpeg_renderer(ffmpeg='C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe')))
system('"C:/Program Files/ImageMagick-7.0.7-Q16/ffmpeg.exe" -i "graphs/qb winz short.mp4" -map 0 -c:v libx264 -c:a copy -y "graphs/qb winz short working.mp4"')
elo_df
qb_wins <- elo_df %>%
select(season, week, team_qb, result, game_type) %>%
left_join(all_weeks) %>%
mutate(
week_order = ifelse(is.na(week_order), 0, week_order)
) %>%
full_join(all_weeks %>% select(week_order), by = character(), suffix = c('_past','')) %>%
filter(week_order_past <= week_order & team_qb != '') %>%
group_by(week_order, team_qb) %>%
summarise(
starts = n(),
wins = sum(ifelse(result > 0, 1, 0)),
sb_wins = sum(ifelse(game_type == 'SB' & result > 0, 1, 0)),
last_start_week = max(week_order_past),
.groups = 'drop'
) %>%
group_by(team_qb) %>%
filter(max(last_start_week) > 0) %>%
ungroup %>%
arrange(-wins) %>%
group_by(week_order) %>%
mutate(
rank = row_number(),
wins_leader = max(wins)
) %>%
ungroup %>%
arrange(week_order, rank)
